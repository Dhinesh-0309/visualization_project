{% load base64encode %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Data Visualizations</title>
</head>
<body>
    <h1>Interactive Data Visualizations</h1>

    {% for chart in charts %}
        <h2>{{ chart.title }}</h2>
        <select id="chart-dropdown-{{ loop.index }}" onchange="updateVisualization({{ loop.index }})">
            {% for type in chart.types %}
                <option value="{{ type }}" {% if chart.default_type == type %}selected{% endif %}>{{ type }}</option>
            {% endfor %}
        </select>
        <div id="chart-container-{{ loop.index }}">
            <div id="chart-{{ loop.index }}" class="chart-container">
                <div id="chart-html-{{ loop.index }}" class="chart-content">
                    {{ chart.html|safe }}
                </div>
                <div id="chart-pie-{{ loop.index }}" class="chart-content" style="display:none">
                    {{ chart.html_pie|safe }}
                </div>
                <div id="chart-heatmap-{{ loop.index }}" class="chart-content" style="display:none">
                    {{ chart.html_heatmap|safe }}
                </div>
                <div id="chart-wordcloud-{{ loop.index }}" class="chart-content" style="display:none">
                    {{ chart.html_wordcloud|safe }}
                </div>
                <div id="chart-line-{{ loop.index }}" class="chart-content" style="display:none">
                    {{ chart.html_line|safe }}
                </div>
                <div id="chart-treemap-{{ loop.index }}" class="chart-content" style="display:none">
                    {{ chart.html_treemap|safe }}
                </div>
                <div id="chart-donut-{{ loop.index }}" class="chart-content" style="display:none">
                    {{ chart.html_donut|safe }}
                </div>
                <div id="chart-box-{{ loop.index }}" class="chart-content" style="display:none">
                    {{ chart.html_box|safe }}
                </div>
                <div id="chart-funnel-{{ loop.index }}" class="chart-content" style="display:none">
                    {{ chart.html_funnel|safe }}
                </div>
            </div>
        </div>
    {% endfor %}

    <script>
        function updateVisualization(chartIndex) {
            // Get the selected chart type from the dropdown
            const selectedType = document.getElementById(`chart-dropdown-${chartIndex}`).value;

            // List of all possible chart types
            const chartTypes = ['html', 'pie', 'heatmap', 'wordcloud', 'line', 'treemap', 'donut', 'box', 'funnel'];

            // Loop over each chart type and hide it
            chartTypes.forEach((type) => {
                const chartElement = document.getElementById(`chart-${type}-${chartIndex}`);
                if (chartElement) {
                    chartElement.style.display = 'none';
                }
            });

            // Show the selected chart type
            const selectedChartElement = document.getElementById(`chart-${selectedType}-${chartIndex}`);
            if (selectedChartElement) {
                selectedChartElement.style.display = 'block';
            }
        }

        // Set the default chart type on page load
        window.onload = function() {
            {% for chart in charts %}
                updateVisualization({{ loop.index }});
            {% endfor %}
        }
    </script>
</body>
</html>

